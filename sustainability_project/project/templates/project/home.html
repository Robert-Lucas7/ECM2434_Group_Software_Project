{% extends 'base.html' %}

{% load static %}

{% block content %}
<div class="challenge-section">
    <!-- Background image set inline to utilize the Django static file system -->
    <div class="background-image" style="background-image: url('{% static 'project/exeter_uni_campus.jpg' %}');"></div>
    <div class="content">
        <h2>{{ daily_challenge|default:"Daily Challenge Sample Text" }}</h2>
        <a href="{% url 'make_post' %}" class="btn btn-primary mt-2">Submit Challenge</a>
    </div>
</div>

<div class="posts-feed">
    {% for post in posts %}
    <div class="post">
        <div class="post-header">
            <a class="username" href="{% url 'profile' post.username %}">{{ post.username }}</a>
            <span class="post-date">{{ post.created_at|date:"H:i M d, Y" }}</span>
        </div>
        <div class="post-content">{{ post.content }}</div>
    </div>
    {% empty %}
    <p>No Posts!</p>
    {% endfor %}
</div>
<script>
    window.addEventListener('scroll', function() {
        const header = document.querySelector('.challenge-section');
        let scrollPosition = window.scrollY < 0 ? 0 : window.scrollY;
    
        // Adjust the size more smoothly based on scroll position
        let newSize = Math.max(100 - scrollPosition / 5, 60); // Adjusted for smoother transition and minimum size
        header.style.height = newSize + "vh";
    
        // Adjust the background image blur, starting from 0px to ensure it's clear on initial load
        const background = document.querySelector('.background-image');
        // Initialize blur effect to 0px on page load
        let initialBlur = 0; // Ensuring background starts without blur
        let newBlur = Math.max(initialBlur, Math.min(scrollPosition / 100, 5)); // Adjusted maximum blur for subtlety        background.style.filter = `blur(${newBlur}px)`;
            });
        // Set initial blur state on page load to 0px
        document.addEventListener("DOMContentLoaded", function() {
            const background = document.querySelector('.background-image');
            background.style.filter = "blur(0px)";
        });
</script>
    
{% endblock %}
