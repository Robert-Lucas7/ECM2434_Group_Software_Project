{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-12 text-center mb-4">
      <!-- Profile Information -->
      <div class="profile-container mb-3">
        <!-- Load profile image from media into page -->
        <img src="/media/{{user.username}}/profile-picture.jpg" alt="Profile Picture" class="profile-picture rounded-circle mb-2">
        <h2 class="username">{{ user.username|default:"Username" }}</h2>
        <div class="stats">
          <p>Current Streak: {{ user.streak|default:"0" }}</p>
          <!-- <p>Monthly Streak: {{ user.profile.stat2|default:"0" }}</p> -->
          <p>Best Streak: {{ user.best_streak|default:"0" }}</p>
          <p>Points: {{ user_points|default:"0" }}</p>
        </div>
      </div>
      <a href="{% url 'make_post' %}"><button class="btn btn-success mb-3" ><!-- type="button" data-toggle="modal" data-target="#challengePopup" -->
        Today's Challenge
      </button>
      </a>
    </div>
    
    <!-- Completed Challenges Section -->
    <div class="col-12 col-lg-8 mb-5"> <!-- Added mb-5 for bottom margin -->
      <div class="border p-4 rounded-3 shadow-sm" style="background-color: #f8f9fa;">
        <h2 class="mb-4 text-center">Completed Challenges</h2>
        {% if user_challenges %}
          <div class="list-group">
            {% for uc in user_challenges %}
              <div class="list-group-item list-group-item-action mb-2 rounded text-start" style="background-color: #e9ecef;">
                <h5 class="mb-1">Title: {{ uc.daily_challenge.challenge.title }}</h5>
                <p class="mb-1">Description: {{ uc.daily_challenge.challenge.description }}</p>
                <p class="mb-1">Response: {{uc.response}}</p>
                <small class="text-muted">Date Completed: {{ uc.submitted|date:"d M Y" }}</small>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <p>No challenges completed.</p>
        {% endif %}
      </div>
    </div>
    <!-- THE BELOW IS FOR TESTING SAVING A FILE TO THE FILESYSTEM -->
    <form method = 'POST' class="col s12" enctype="multipart/form-data">
 
        {% csrf_token %}

        {{new_form.as_p}}

    <!--Below is our main file upload input -->
        <input type = "file" name = 'document'>
        <p><button type = "submit" class = "waves-effect waves-light btn" style = "background-color: teal">Publish</button></p>
  </form>


{% endblock %}